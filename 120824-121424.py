import datetime
import pandas as pd

# Set the start date
start_date = datetime.datetime(2024, 12, 8)

# Create a list of dates for the week
dates = [start_date + datetime.timedelta(days=i) for i in range(7)]

# Create a list of time slots for each hour of the day
time_slots = [f"{hour:02d}:00 - {hour + 1:02d}:00" for hour in range(24)]

# Create a multi-index from dates and time slots
index = pd.MultiIndex.from_product([dates, time_slots], names=['Date', 'Time Slot'])

# Create an empty DataFrame with the multi-index
weekly_calendar = pd.DataFrame(index=index, columns=['Event'])

# Function to add an event to the calendar
def add_event(date, time_slot, event):
    if (date, time_slot) in weekly_calendar.index:
        weekly_calendar.loc[(date, time_slot), 'Event'] = event
    else:
        print("Invalid date or time slot")

# Add events for the entire day on 11/29/2024
add_event(datetime.datetime(2024, 12, 8), "00:00 - 01:00", "Sleep")
add_event(datetime.datetime(2024, 12, 8), "01:00 - 02:00", "Sleep")
add_event(datetime.datetime(2024, 12, 8), "02:00 - 03:00", "Sleep")
add_event(datetime.datetime(2024, 12, 8), "03:00 - 04:00", "Sleep")
add_event(datetime.datetime(2024, 12, 8), "03:00 - 04:00", "Sleep")
add_event(datetime.datetime(2024, 12, 8), "04:00 - 05:00", "Sleep")
add_event(datetime.datetime(2024, 12, 8), "05:00 - 06:00", "Sleep")
add_event(datetime.datetime(2024, 12, 8), "06:00 - 07:00", "Sleep")
add_event(datetime.datetime(2024, 12, 8), "07:00 - 08:00", "Sleep")
add_event(datetime.datetime(2024, 12, 8), "08:00 - 09:00", "Morning Exercise")
add_event(datetime.datetime(2024, 12, 8), "09:00 - 10:00", "Gen Work")
add_event(datetime.datetime(2024, 12, 8), "10:00 - 11:00", "Gen Work")
add_event(datetime.datetime(2024, 12, 8), "11:00 - 12:00", "Gen Work")
add_event(datetime.datetime(2024, 12, 8), "12:00 - 13:00", "Gen Work")
add_event(datetime.datetime(2024, 12, 8), "13:00 - 14:00", "Gen Work")
add_event(datetime.datetime(2024, 12, 8), "14:00 - 15:00", "Gen Work")
add_event(datetime.datetime(2024, 12, 8), "15:00 - 16:00", "Gen Work")
add_event(datetime.datetime(2024, 12, 8), "16:00 - 17:00", "Gen Work")
add_event(datetime.datetime(2024, 12, 8), "17:00 - 18:00", "Gen Work")
add_event(datetime.datetime(2024, 12, 8), "18:00 - 19:00", "Gen Work")
add_event(datetime.datetime(2024, 12, 8), "19:00 - 20:00", "Gen Work")
add_event(datetime.datetime(2024, 12, 8), "20:00 - 21:00", "RandR")
add_event(datetime.datetime(2024, 12, 8), "21:00 - 22:00", "RandR")
add_event(datetime.datetime(2024, 12, 8), "22:00 - 23:00", "Sleep")
add_event(datetime.datetime(2024, 12, 8), "23:00 - 24:00", "Zzzz")
add_event(datetime.datetime(2024, 12, 9), "00:00 - 01:00", "Sleep")
add_event(datetime.datetime(2024, 12, 9), "01:00 - 02:00", "Sleep")
add_event(datetime.datetime(2024, 12, 9), "02:00 - 03:00", "Sleep")
add_event(datetime.datetime(2024, 12, 9), "03:00 - 04:00", "Sleep")
add_event(datetime.datetime(2024, 12, 9), "04:00 - 05:00", "Sleep")
add_event(datetime.datetime(2024, 12, 9), "05:00 - 06:00", "Morning Walk")
add_event(datetime.datetime(2024, 12, 9), "06:00 - 07:00", "Breakfast")
add_event(datetime.datetime(2024, 12, 9), "07:00 - 08:00", "Work Akamai Foot Doctors")
add_event(datetime.datetime(2024, 12, 9), "08:00 - 09:00", "Work Akamai Foot Doctors")
add_event(datetime.datetime(2024, 12, 9), "09:00 - 10:00", "Work Akamai Foot Doctors")
add_event(datetime.datetime(2024, 12, 9), "10:00 - 11:00", "Work Akamai Foot Doctors")
add_event(datetime.datetime(2024, 12, 9), "11:00 - 12:00", "Work Akamai Foot Doctors")
add_event(datetime.datetime(2024, 12, 9), "12:00 - 13:00", "Work Akamai Foot Doctors")
add_event(datetime.datetime(2024, 12, 9), "13:00 - 14:00", "School Work")
add_event(datetime.datetime(2024, 12, 9), "14:00 - 15:00", "School Work")
add_event(datetime.datetime(2024, 12, 9), "15:00 - 16:00", "School Work")
add_event(datetime.datetime(2024, 12, 9), "16:00 - 17:00", "School Work")
add_event(datetime.datetime(2024, 12, 9), "17:00 - 18:00", "Time Off")
add_event(datetime.datetime(2024, 12, 9), "18:00 - 19:00", "Time Off")
add_event(datetime.datetime(2024, 12, 9), "19:00 - 20:00", "Time Off")
add_event(datetime.datetime(2024, 12, 9), "20:00 - 21:00", "Sleep")
add_event(datetime.datetime(2024, 12, 9), "21:00 - 22:00", "Sleep")
add_event(datetime.datetime(2024, 12, 9), "22:00 - 23:00", "Sleep")
add_event(datetime.datetime(2024, 12, 9), "23:00 - 24:00", "Sleep")
add_event(datetime.datetime(2024, 12, 10), "00:00 - 01:00", "Sleep")
add_event(datetime.datetime(2024, 12, 10), "01:00 - 02:00", "Sleep")
add_event(datetime.datetime(2024, 12, 10), "02:00 - 03:00", "Sleep")
add_event(datetime.datetime(2024, 12, 10), "03:00 - 04:00", "Sleep")
add_event(datetime.datetime(2024, 12, 10), "04:00 - 05:00", "Sleep")
add_event(datetime.datetime(2024, 12, 10), "05:00 - 06:00", "Sleep")
add_event(datetime.datetime(2024, 12, 10), "06:00 - 07:00", "Sleep")
add_event(datetime.datetime(2024, 12, 10), "07:00 - 08:00", "School")
add_event(datetime.datetime(2024, 12, 10), "08:00 - 09:00", "School")
add_event(datetime.datetime(2024, 12, 10), "09:00 - 10:00", "School")
add_event(datetime.datetime(2024, 12, 10), "10:00 - 11:00", "School")
add_event(datetime.datetime(2024, 12, 10), "11:00 - 12:00", "School Work")
add_event(datetime.datetime(2024, 12, 10), "12:00 - 13:00", "School Work")
add_event(datetime.datetime(2024, 12, 10), "13:00 - 14:00", "School Work")
add_event(datetime.datetime(2024, 12, 10), "14:00 - 15:00", "School Work")
add_event(datetime.datetime(2024, 12, 10), "15:00 - 16:00", "School Work")
add_event(datetime.datetime(2024, 12, 10), "16:00 - 17:00", "School Work")
add_event(datetime.datetime(2024, 12, 10), "17:00 - 18:00", "School Work")  
add_event(datetime.datetime(2024, 12, 10), "18:00 - 19:00", "RandR")
add_event(datetime.datetime(2024, 12, 10), "19:00 - 20:00", "RandR")
add_event(datetime.datetime(2024, 12, 10), "20:00 - 21:00", "Sleep")
add_event(datetime.datetime(2024, 12, 10), "21:00 - 22:00", "Sleep")
add_event(datetime.datetime(2024, 12, 10), "22:00 - 23:00", "Sleep")
add_event(datetime.datetime(2024, 12, 10), "23:00 - 24:00", "Sleep")
add_event(datetime.datetime(2024, 12, 11), "00:00 - 01:00", "Sleep")
add_event(datetime.datetime(2024, 12, 11), "01:00 - 02:00", "Sleep")
add_event(datetime.datetime(2024, 12, 11), "02:00 - 03:00", "Sleep")
add_event(datetime.datetime(2024, 12, 11), "03:00 - 04:00", "Sleep")
add_event(datetime.datetime(2024, 12, 11), "04:00 - 05:00", "Morning Walk")
add_event(datetime.datetime(2024, 12, 11), "05:00 - 06:00", "Breakfast")
add_event(datetime.datetime(2024, 12, 11), "06:00 - 07:00", "Work Akamai Foot Doctors")
add_event(datetime.datetime(2024, 12, 11), "07:00 - 08:00", "Work Akamai Foot Doctors")
add_event(datetime.datetime(2024, 12, 11), "08:00 - 09:00", "Work Akamai Foot Doctors")
add_event(datetime.datetime(2024, 12, 11), "09:00 - 10:00", "Work Akamai Foot Doctors")
add_event(datetime.datetime(2024, 12, 11), "10:00 - 11:00", "Work Akamai Foot Doctors")
add_event(datetime.datetime(2024, 12, 11), "11:00 - 12:00", "Work Akamai Foot Doctors")
add_event(datetime.datetime(2024, 12, 11), "12:00 - 13:00", "Work Akamai Foot Doctors")
add_event(datetime.datetime(2024, 12, 11), "13:00 - 14:00", "School Work")
add_event(datetime.datetime(2024, 12, 11), "14:00 - 15:00", "School Work")
add_event(datetime.datetime(2024, 12, 11), "15:00 - 16:00", "School Work")
add_event(datetime.datetime(2024, 12, 11), "16:00 - 17:00", "School Work")
add_event(datetime.datetime(2024, 12, 11), "17:00 - 18:00", "School Work")
add_event(datetime.datetime(2024, 12, 11), "18:00 - 19:00", "Sleep")
add_event(datetime.datetime(2024, 12, 11), "19:00 - 20:00", "Sleep")
add_event(datetime.datetime(2024, 12, 11), "20:00 - 21:00", "Sleep")
add_event(datetime.datetime(2024, 12, 11), "21:00 - 22:00", "Sleep")
add_event(datetime.datetime(2024, 12, 11), "22:00 - 23:00", "Sleep")
add_event(datetime.datetime(2024, 12, 11), "23:00 - 24:00", "Sleep")
add_event(datetime.datetime(2024, 12, 12), "00:00 - 01:00", "Sleep")
add_event(datetime.datetime(2024, 12, 12), "01:00 - 02:00", "Sleep")
add_event(datetime.datetime(2024, 12, 12), "02:00 - 03:00", "Sleep")
add_event(datetime.datetime(2024, 12, 12), "03:00 - 04:00", "Sleep")
add_event(datetime.datetime(2024, 12, 12), "04:00 - 05:00", "Sleep")
add_event(datetime.datetime(2024, 12, 12), "05:00 - 06:00", "Breakfast")
add_event(datetime.datetime(2024, 12, 12), "06:00 - 07:00", "School")
add_event(datetime.datetime(2024, 12, 12), "07:00 - 08:00", "School")
add_event(datetime.datetime(2024, 12, 12), "08:00 - 09:00", "School")
add_event(datetime.datetime(2024, 12, 12), "09:00 - 10:00", "School")
add_event(datetime.datetime(2024, 12, 12), "10:00 - 11:00", "School")
add_event(datetime.datetime(2024, 12, 12), "11:00 - 12:00", "School")
add_event(datetime.datetime(2024, 12, 12), "12:00 - 13:00", "School Work")
add_event(datetime.datetime(2024, 12, 12), "13:00 - 14:00", "School Work")
add_event(datetime.datetime(2024, 12, 12), "14:00 - 15:00", "School Work")
add_event(datetime.datetime(2024, 12, 12), "15:00 - 16:00", "School Work")
add_event(datetime.datetime(2024, 12, 12), "16:00 - 17:00", "School Work")
add_event(datetime.datetime(2024, 12, 12), "17:00 - 18:00", "RandR")
add_event(datetime.datetime(2024, 12, 12), "18:00 - 19:00", "RandR")
add_event(datetime.datetime(2024, 12, 12), "19:00 - 20:00", "RandR")
add_event(datetime.datetime(2024, 12, 12), "20:00 - 21:00", "RandR")
add_event(datetime.datetime(2024, 12, 12), "21:00 - 22:00", "Sleep")
add_event(datetime.datetime(2024, 12, 12), "22:00 - 23:00", "Sleep")
add_event(datetime.datetime(2024, 12, 12), "23:00 - 24:00", "Sleep")
add_event(datetime.datetime(2024, 12, 13), "00:00 - 01:00", "Sleep")
add_event(datetime.datetime(2024, 12, 13), "01:00 - 02:00", "Sleep")
add_event(datetime.datetime(2024, 12, 13), "02:00 - 03:00", "Sleep")
add_event(datetime.datetime(2024, 12, 13), "03:00 - 04:00", "Sleep")
add_event(datetime.datetime(2024, 12, 13), "04:00 - 05:00", "Morning Walk")
add_event(datetime.datetime(2024, 12, 13), "05:00 - 06:00", "Breakfast")
add_event(datetime.datetime(2024, 12, 13), "06:00 - 07:00", "Work Akamai Foot Doctors")
add_event(datetime.datetime(2024, 12, 13), "07:00 - 08:00", "Work Akamai Foot Doctors")
add_event(datetime.datetime(2024, 12, 13), "08:00 - 09:00", "Work Akamai Foot Doctors")
add_event(datetime.datetime(2024, 12, 13), "09:00 - 10:00", "Work Akamai Foot Doctors")
add_event(datetime.datetime(2024, 12, 13), "10:00 - 11:00", "Work Akamai Foot Doctors")
add_event(datetime.datetime(2024, 12, 13), "11:00 - 12:00", "Work Akamai Foot Doctors")
add_event(datetime.datetime(2024, 12, 13), "12:00 - 13:00", "Work Akamai Foot Doctors")
add_event(datetime.datetime(2024, 12, 13), "13:00 - 14:00", "Lunch")
add_event(datetime.datetime(2024, 12, 13), "14:00 - 15:00", "School Work")
add_event(datetime.datetime(2024, 12, 13), "15:00 - 16:00", "School Work")
add_event(datetime.datetime(2024, 12, 13), "16:00 - 17:00", "School Work")
add_event(datetime.datetime(2024, 12, 13), "17:00 - 18:00", "School Work")
add_event(datetime.datetime(2024, 12, 13), "18:00 - 19:00", "School Work")
add_event(datetime.datetime(2024, 12, 13), "19:00 - 20:00", "School Work")
add_event(datetime.datetime(2024, 12, 13), "20:00 - 21:00", "School Work")
add_event(datetime.datetime(2024, 12, 13), "21:00 - 22:00", "Sleep")
add_event(datetime.datetime(2024, 12, 13), "22:00 - 23:00", "Sleep")
add_event(datetime.datetime(2024, 12, 13), "23:00 - 24:00", "Sleep")
add_event(datetime.datetime(2024, 12, 14), "00:00 - 01:00", "Sleep")
add_event(datetime.datetime(2024, 12, 14), "01:00 - 02:00", "Sleep")
add_event(datetime.datetime(2024, 12, 14), "02:00 - 03:00", "Sleep")
add_event(datetime.datetime(2024, 12, 14), "03:00 - 04:00", "Sleep")
add_event(datetime.datetime(2024, 12, 14), "04:00 - 05:00", "Sleep")
add_event(datetime.datetime(2024, 12, 14), "05:00 - 06:00", "GOOD Morning")
add_event(datetime.datetime(2024, 12, 14), "06:00 - 07:00", "Morning Walk")
add_event(datetime.datetime(2024, 12, 14), "07:00 - 08:00", "Work GEN")
add_event(datetime.datetime(2024, 12, 14), "08:00 - 09:00", "Work GEN")
add_event(datetime.datetime(2024, 12, 14), "09:00 - 10:00", "Work GEN")
add_event(datetime.datetime(2024, 12, 14), "10:00 - 11:00", "Work GEN")
add_event(datetime.datetime(2024, 12, 14), "11:00 - 12:00", "Work GEN")
add_event(datetime.datetime(2024, 12, 14), "12:00 - 13:00", "Work GEN")
add_event(datetime.datetime(2024, 12, 14), "13:00 - 14:00", "Work GEN")
add_event(datetime.datetime(2024, 12, 14), "14:00 - 15:00", "Work GEN")
add_event(datetime.datetime(2024, 12, 14), "15:00 - 16:00", "Work GEN")
add_event(datetime.datetime(2024, 12, 14), "16:00 - 17:00", "Work GEN")
add_event(datetime.datetime(2024, 12, 14), "17:00 - 18:00", "Work GEN")
add_event(datetime.datetime(2024, 12, 14), "18:00 - 19:00", "Work GEN")
add_event(datetime.datetime(2024, 12, 14), "19:00 - 20:00", "Work GEN")
add_event(datetime.datetime(2024, 12, 14), "20:00 - 21:00", "Work GEN")
add_event(datetime.datetime(2024, 12, 14), "21:00 - 22:00", "Sleep")
add_event(datetime.datetime(2024, 12, 14), "22:00 - 23:00", "Sleep")
add_event(datetime.datetime(2024, 12, 14), "23:00 - 24:00", "Sleep")

# Function to view the calendar with only scheduled events
def view_scheduled_events():
    scheduled_events = weekly_calendar.dropna()
    print(scheduled_events)

# Verify that every time slot for each day is present
def verify_time_slots():
    expected_slots = set(index)
    actual_slots = set(weekly_calendar.index)
    missing_slots = expected_slots - actual_slots

    if not missing_slots:
        print("All time slots are correctly included.")
    else:
        print("Missing time slots:")
        for slot in sorted(missing_slots):
            print(slot)

# Function to export the weekly events to an Excel file
def export_weekly_to_excel():
    weekly_events = weekly_calendar.dropna().reset_index()
    file_name = f'weekly_events_{dates[-1].strftime("%Y%m%d")}.xlsx'
    with pd.ExcelWriter(file_name, engine='xlsxwriter') as writer:
        weekly_events.to_excel(writer, sheet_name='Events', index=False)
    print(f"Weekly events exported to {file_name}")

# Verify all time slots are present
verify_time_slots()

# View the calendar with only scheduled events
view_scheduled_events()

# Export weekly events to an Excel file
export_weekly_to_excel()
